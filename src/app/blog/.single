import React from 'react'
import PageContent from './../../components/PageContent'
import BlogNav from './shared/BlogNav'
import BlogContent from './shared/BlogContent'
import RelatedLinks from './RelatedLinks'
import { client } from './../../store/contentfulClientApi'

const splitUrl = (string) => {
  let str = string.split('=')[1];
  return str;
}

const getEntry = (id) => {
 return client.getEntry( id )
    .then(function (entry){
       return entry; 
    })
    .catch( error =>  {
      console.log(error);
    })

}
//The promise value can only be used wrapped arount that whole church of code
const getURL = () => {
  let url = window.location.search;
  let entry = splitUrl(url);
  let data = getEntry(entry);

 return data.then(function(value){
      return value; 
  })
}


const SingleBlogPost = ( {location: {state:{ props }}} ) => {
  return(
    <div>
      { 1 === 1 ?
        console.log(getURL())
      //    props = getURL(),
      //  props.then(function(value){
      //    console.log(value)
      //  }))
        :
        <div className="columns is-mobile">
          <PageContent style={{height: '680px', margin: '0 1em 0 14em'}} className="scrollBar column is-three-fifths" id="singlePost">
          <BlogNav to="/blog" date={props.date}/>
          <BlogContent {...props}/>
          </PageContent> 
          <RelatedLinks links={props.related} />
        </div>
      }
    </div>
  )
}
export default SingleBlogPost

